# 5-1. 制御構文（条件分岐）

この章では、条件に応じて処理を分岐させる「条件分岐」について学びます。条件分岐を理解することで、様々な状況に対応できるプログラムを作成できるようになります。

---

## 目次

- [条件分岐を記述しよう if / else / else if](#条件分岐を記述しよう-if--else--else-if)
- [様々な比較演算子を使ってみよう](#様々な比較演算子を使ってみよう)
- [論理演算子を使おう](#論理演算子を使おう)
- [条件分岐の入れ子](#条件分岐の入れ子)
- [条件分岐switchを使おう](#条件分岐switchを使おう)
- [三項演算子を使おう](#三項演算子を使おう)
- [まとめ](#まとめ)
- [演習問題](#演習問題)

---

## 条件分岐を記述しよう if / else / else if

### 条件分岐とは
条件分岐は、**条件に応じて処理を分ける**機能です。

### if文の基本

```typescript
if (条件) {
    // 条件がtrueの場合に実行される処理
}
```

### if-else文

```typescript
if (条件) {
    // 条件がtrueの場合
} else {
    // 条件がfalseの場合
}
```

### if-else if-else文

```typescript
if (条件1) {
    // 条件1がtrueの場合
} else if (条件2) {
    // 条件1がfalseで、条件2がtrueの場合
} else {
    // すべての条件がfalseの場合
}
```

### 実践例: if / else / else if

```typescript
// src/if-else.ts
// 基本的なif文
let age = 20;

if (age >= 18) {
    console.log("成人です");
}

// if-else文
let score = 80;

if (score >= 60) {
    console.log("合格です");
} else {
    console.log("不合格です");
}

// if-else if-else文
let temperature = 25;

if (temperature >= 30) {
    console.log("暑いです");
} else if (temperature >= 20) {
    console.log("快適です");
} else if (temperature >= 10) {
    console.log("少し寒いです");
} else {
    console.log("寒いです");
}

// 実践例: 成績判定
function getGrade(score: number): string {
    if (score >= 90) {
        return "A";
    } else if (score >= 80) {
        return "B";
    } else if (score >= 70) {
        return "C";
    } else if (score >= 60) {
        return "D";
    } else {
        return "F";
    }
}

console.log(`85点: ${getGrade(85)}`); // B
console.log(`75点: ${getGrade(75)}`); // C
console.log(`55点: ${getGrade(55)}`); // F

// 実践例: ログイン判定
function checkLogin(isLoggedIn: boolean): void {
    if (isLoggedIn) {
        console.log("ログイン中です");
    } else {
        console.log("ログインしてください");
    }
}

checkLogin(true);  // ログイン中です
checkLogin(false); // ログインしてください
```

---

## 様々な比較演算子を使ってみよう

### 比較演算子とは
比較演算子は、**2つの値を比較する**演算子です。

### 等価演算子

#### ==（等価）
```typescript
let a = 10;
let b = "10";

console.log(a == b);  // true（型変換される）
```

#### ===（厳密等価）
```typescript
let a = 10;
let b = "10";

console.log(a === b); // false（型が異なる）
```

### 不等価演算子

#### !=（不等価）
```typescript
let a = 10;
let b = 20;

console.log(a != b);  // true
```

#### !==（厳密不等価）
```typescript
let a = 10;
let b = "10";

console.log(a !== b); // true（型が異なる）
```

### 大小比較演算子

#### <（小なり）
```typescript
let a = 10;
let b = 20;

if (a < b) {
    console.log("aはbより小さい");
}
```

#### >（大なり）
```typescript
let a = 20;
let b = 10;

if (a > b) {
    console.log("aはbより大きい");
}
```

#### <=（以下）
```typescript
let a = 10;
let b = 10;

if (a <= b) {
    console.log("aはb以下");
}
```

#### >=（以上）
```typescript
let a = 20;
let b = 10;

if (a >= b) {
    console.log("aはb以上");
}
```

### 実践例: 様々な比較演算子

```typescript
// src/comparison-operators.ts
// 等価演算子
let a = 10;
let b = 10;
let c = "10";

console.log(`a == b: ${a == b}`);   // true
console.log(`a == c: ${a == c}`);   // true（型変換される）
console.log(`a === b: ${a === b}`); // true
console.log(`a === c: ${a === c}`); // false（型が異なる）

// 不等価演算子
let x = 10;
let y = 20;

console.log(`x != y: ${x != y}`);   // true
console.log(`x !== y: ${x !== y}`); // true

// 大小比較演算子
let num1 = 10;
let num2 = 20;

if (num1 < num2) {
    console.log(`${num1}は${num2}より小さい`);
}

if (num2 > num1) {
    console.log(`${num2}は${num1}より大きい`);
}

if (num1 <= num2) {
    console.log(`${num1}は${num2}以下`);
}

if (num2 >= num1) {
    console.log(`${num2}は${num1}以上`);
}

// 実践例: 年齢チェック
function checkAge(age: number): void {
    if (age < 0) {
        console.log("無効な年齢です");
    } else if (age < 18) {
        console.log("未成年です");
    } else if (age < 65) {
        console.log("成人です");
    } else {
        console.log("高齢者です");
    }
}

checkAge(15);  // 未成年です
checkAge(25);  // 成人です
checkAge(70);  // 高齢者です

// 実践例: パスワードチェック
function checkPassword(password: string): void {
    if (password.length < 8) {
        console.log("パスワードは8文字以上必要です");
    } else if (password.length > 20) {
        console.log("パスワードは20文字以下である必要があります");
    } else {
        console.log("パスワードの長さは適切です");
    }
}

checkPassword("12345");        // パスワードは8文字以上必要です
checkPassword("12345678");      // パスワードの長さは適切です
checkPassword("123456789012345678901"); // パスワードは20文字以下である必要があります
```

---

## 論理演算子を使おう

### 論理演算子とは
論理演算子は、**複数の条件を組み合わせる**演算子です。

### AND演算子（&&）

```typescript
if (条件1 && 条件2) {
    // 両方の条件がtrueの場合
}
```

### OR演算子（||）

```typescript
if (条件1 || 条件2) {
    // どちらかの条件がtrueの場合
}
```

### NOT演算子（!）

```typescript
if (!条件) {
    // 条件がfalseの場合
}
```

### 実践例: 論理演算子

```typescript
// src/logical-operators.ts
// AND演算子（&&）
let age = 25;
let hasLicense = true;

if (age >= 18 && hasLicense) {
    console.log("運転可能です");
} else {
    console.log("運転できません");
}

// OR演算子（||）
let isStudent = false;
let isTeacher = true;

if (isStudent || isTeacher) {
    console.log("教育関係者です");
} else {
    console.log("教育関係者ではありません");
}

// NOT演算子（!）
let isActive = false;

if (!isActive) {
    console.log("非アクティブです");
} else {
    console.log("アクティブです");
}

// 複数の論理演算子を組み合わせる
let score = 85;
let attendance = 90;

if (score >= 80 && attendance >= 80) {
    console.log("優秀です");
} else if (score >= 60 || attendance >= 60) {
    console.log("合格です");
} else {
    console.log("不合格です");
}

// 実践例: ログイン判定
function canLogin(username: string, password: string, isVerified: boolean): boolean {
    if (username.length > 0 && password.length > 0 && isVerified) {
        return true;
    }
    return false;
}

console.log(canLogin("user", "pass", true));   // true
console.log(canLogin("user", "", true));       // false
console.log(canLogin("user", "pass", false)); // false

// 実践例: 割引判定
function getDiscount(age: number, isStudent: boolean, isMember: boolean): number {
    if (age >= 65 || isStudent) {
        return 0.2; // 20%割引
    } else if (isMember) {
        return 0.1; // 10%割引
    }
    return 0; // 割引なし
}

console.log(`高齢者の割引: ${getDiscount(70, false, false) * 100}%`); // 20%
console.log(`学生の割引: ${getDiscount(20, true, false) * 100}%`);   // 20%
console.log(`会員の割引: ${getDiscount(30, false, true) * 100}%`);   // 10%
```

---

## 条件分岐の入れ子

### 入れ子とは
入れ子は、**条件分岐の中に別の条件分岐を書く**ことです。

### 入れ子の基本

```typescript
if (条件1) {
    if (条件2) {
        // 条件1と条件2が両方trueの場合
    }
}
```

### 実践例: 条件分岐の入れ子

```typescript
// src/nested-conditions.ts
// 基本的な入れ子
let age = 25;
let hasLicense = true;

if (age >= 18) {
    if (hasLicense) {
        console.log("運転可能です");
    } else {
        console.log("免許証が必要です");
    }
} else {
    console.log("18歳未満は運転できません");
}

// 複数レベルの入れ子
let score = 85;
let attendance = 90;

if (score >= 80) {
    if (attendance >= 90) {
        console.log("優秀（A+）");
    } else if (attendance >= 80) {
        console.log("優秀（A）");
    } else {
        console.log("良好（B）");
    }
} else if (score >= 60) {
    if (attendance >= 80) {
        console.log("合格（C）");
    } else {
        console.log("条件付き合格（D）");
    }
} else {
    console.log("不合格（F）");
}

// 実践例: ユーザー権限チェック
function checkPermission(role: string, isActive: boolean, hasAccess: boolean): void {
    if (isActive) {
        if (role === "admin") {
            if (hasAccess) {
                console.log("管理者権限でアクセス可能");
            } else {
                console.log("アクセス権限がありません");
            }
        } else if (role === "user") {
            if (hasAccess) {
                console.log("ユーザー権限でアクセス可能");
            } else {
                console.log("アクセス権限がありません");
            }
        } else {
            console.log("無効なロールです");
        }
    } else {
        console.log("アカウントが非アクティブです");
    }
}

checkPermission("admin", true, true);   // 管理者権限でアクセス可能
checkPermission("user", true, true);     // ユーザー権限でアクセス可能
checkPermission("admin", true, false);   // アクセス権限がありません
checkPermission("user", false, true);    // アカウントが非アクティブです

// 実践例: 商品価格計算
function calculatePrice(basePrice: number, isMember: boolean, hasCoupon: boolean): number {
    let price = basePrice;
    
    if (isMember) {
        price = price * 0.9; // 10%割引
        
        if (hasCoupon) {
            price = price * 0.95; // さらに5%割引
        }
    } else {
        if (hasCoupon) {
            price = price * 0.95; // 5%割引
        }
    }
    
    return price;
}

console.log(`会員+クーポン: ${calculatePrice(1000, true, true)}円`);   // 855円
console.log(`会員のみ: ${calculatePrice(1000, true, false)}円`);       // 900円
console.log(`クーポンのみ: ${calculatePrice(1000, false, true)}円`);    // 950円
console.log(`通常: ${calculatePrice(1000, false, false)}円`);          // 1000円
```

---

## 条件分岐switchを使おう

### switch文とは
switch文は、**複数の条件を分岐させる**構文です。if-else ifの連続を簡潔に書けます。

### switch文の基本構文

```typescript
switch (値) {
    case 値1:
        // 値が値1の場合
        break;
    case 値2:
        // 値が値2の場合
        break;
    default:
        // どの値にも一致しない場合
        break;
}
```

### break文の重要性

```typescript
// breakがない場合（フォールスルー）
switch (value) {
    case 1:
        console.log("1");
        // breakがないと次のcaseも実行される
    case 2:
        console.log("2");
        break;
}
```

### 実践例: switch文

```typescript
// src/switch.ts
// 基本的なswitch文
function getDayName(day: number): string {
    switch (day) {
        case 0:
            return "日曜日";
        case 1:
            return "月曜日";
        case 2:
            return "火曜日";
        case 3:
            return "水曜日";
        case 4:
            return "木曜日";
        case 5:
            return "金曜日";
        case 6:
            return "土曜日";
        default:
            return "無効な日";
    }
}

console.log(getDayName(0)); // 日曜日
console.log(getDayName(3)); // 水曜日
console.log(getDayName(7)); // 無効な日

// 文字列のswitch文
function getStatusMessage(status: string): string {
    switch (status) {
        case "success":
            return "成功しました";
        case "error":
            return "エラーが発生しました";
        case "warning":
            return "警告です";
        case "info":
            return "情報です";
        default:
            return "不明なステータス";
    }
}

console.log(getStatusMessage("success")); // 成功しました
console.log(getStatusMessage("error"));   // エラーが発生しました

// 複数のcaseをまとめる
function getSeason(month: number): string {
    switch (month) {
        case 12:
        case 1:
        case 2:
            return "冬";
        case 3:
        case 4:
        case 5:
            return "春";
        case 6:
        case 7:
        case 8:
            return "夏";
        case 9:
        case 10:
        case 11:
            return "秋";
        default:
            return "無効な月";
    }
}

console.log(getSeason(1));  // 冬
console.log(getSeason(4));  // 春
console.log(getSeason(7));  // 夏
console.log(getSeason(10)); // 秋

// 実践例: 計算機
function calculate(operation: string, a: number, b: number): number {
    switch (operation) {
        case "add":
            return a + b;
        case "subtract":
            return a - b;
        case "multiply":
            return a * b;
        case "divide":
            if (b === 0) {
                throw new Error("0で割ることはできません");
            }
            return a / b;
        default:
            throw new Error("無効な演算です");
    }
}

console.log(`10 + 5 = ${calculate("add", 10, 5)}`);      // 15
console.log(`10 - 5 = ${calculate("subtract", 10, 5)}`);  // 5
console.log(`10 * 5 = ${calculate("multiply", 10, 5)}`); // 50
console.log(`10 / 5 = ${calculate("divide", 10, 5)}`);  // 2
```

---

## 三項演算子を使おう

### 三項演算子とは
三項演算子は、**if-else文を1行で書く**構文です。

### 三項演算子の基本構文

```typescript
条件 ? 真の場合の値 : 偽の場合の値
```

### 基本的な使い方

```typescript
let age = 20;
let message = age >= 18 ? "成人" : "未成年";
console.log(message); // "成人"
```

### 入れ子の三項演算子

```typescript
let score = 85;
let grade = score >= 90 ? "A" : score >= 80 ? "B" : score >= 70 ? "C" : "D";
console.log(grade); // "B"
```

### 実践例: 三項演算子

```typescript
// src/ternary-operator.ts
// 基本的な三項演算子
let age = 20;
let status = age >= 18 ? "成人" : "未成年";
console.log(status); // 成人

// 数値の判定
let score = 85;
let result = score >= 60 ? "合格" : "不合格";
console.log(result); // 合格

// 真偽値の判定
let isActive = true;
let message = isActive ? "アクティブ" : "非アクティブ";
console.log(message); // アクティブ

// 入れ子の三項演算子
let temperature = 25;
let weather = temperature >= 30 ? "暑い" : temperature >= 20 ? "快適" : "寒い";
console.log(weather); // 快適

// 実践例: 割引計算
function getDiscountPrice(price: number, isMember: boolean): number {
    return isMember ? price * 0.9 : price;
}

console.log(`会員価格: ${getDiscountPrice(1000, true)}円`);   // 900円
console.log(`通常価格: ${getDiscountPrice(1000, false)}円`);  // 1000円

// 実践例: メッセージ表示
function getWelcomeMessage(isLoggedIn: boolean, userName?: string): string {
    return isLoggedIn 
        ? `こんにちは、${userName}さん` 
        : "ログインしてください";
}

console.log(getWelcomeMessage(true, "太郎"));  // こんにちは、太郎さん
console.log(getWelcomeMessage(false));          // ログインしてください

// 実践例: 成績判定
function getGrade(score: number): string {
    return score >= 90 ? "A" 
         : score >= 80 ? "B" 
         : score >= 70 ? "C" 
         : score >= 60 ? "D" 
         : "F";
}

console.log(`85点: ${getGrade(85)}`); // B
console.log(`75点: ${getGrade(75)}`); // C
console.log(`55点: ${getGrade(55)}`); // F

// 注意: 複雑な条件はif-else文の方が読みやすい
// 三項演算子はシンプルな条件に使う
```

---

## まとめ

この章では、TypeScriptの条件分岐について学びました。

### 学んだこと
- if / else / else if文
- 様々な比較演算子
- 論理演算子（&&, ||, !）
- 条件分岐の入れ子
- switch文
- 三項演算子

### 重要なポイント
1. **if-else**: 基本的な条件分岐
2. **比較演算子**: ===（厳密等価）を使うことを推奨
3. **論理演算子**: 複数の条件を組み合わせる
4. **switch文**: 複数の値による分岐に適している
5. **三項演算子**: シンプルな条件分岐を1行で書ける

### 次のステップ
次の章では、繰り返し処理（ループ）について詳しく学びます。

---

## 演習問題

### 問題1: if-else文
変数`age`が18以上なら「成人」、そうでなければ「未成年」と表示してください。

<details>
<summary>解答例</summary>

```typescript
let age = 20;

if (age >= 18) {
    console.log("成人");
} else {
    console.log("未成年");
}
```
</details>

### 問題2: 比較演算子
2つの数値`a`と`b`を比較し、大きい方を表示してください。

<details>
<summary>解答例</summary>

```typescript
let a = 10;
let b = 20;

if (a > b) {
    console.log(`大きい値: ${a}`);
} else {
    console.log(`大きい値: ${b}`);
}
```
</details>

### 問題3: 論理演算子
`age >= 18`と`hasLicense`の両方がtrueの場合に「運転可能」と表示してください。

<details>
<summary>解答例</summary>

```typescript
let age = 25;
let hasLicense = true;

if (age >= 18 && hasLicense) {
    console.log("運転可能");
} else {
    console.log("運転できません");
}
```
</details>

### 問題4: switch文
数値`day`（0-6）を受け取り、対応する曜日名を返す関数を作成してください。

<details>
<summary>解答例</summary>

```typescript
function getDayName(day: number): string {
    switch (day) {
        case 0:
            return "日曜日";
        case 1:
            return "月曜日";
        case 2:
            return "火曜日";
        case 3:
            return "水曜日";
        case 4:
            return "木曜日";
        case 5:
            return "金曜日";
        case 6:
            return "土曜日";
        default:
            return "無効な日";
    }
}

console.log(getDayName(0)); // 日曜日
```
</details>

### 問題5: 三項演算子
変数`score`が60以上なら「合格」、そうでなければ「不合格」を三項演算子で表示してください。

<details>
<summary>解答例</summary>

```typescript
let score = 85;
let result = score >= 60 ? "合格" : "不合格";
console.log(result); // 合格
```
</details>

---

お疲れ様でした！次の章に進みましょう。



